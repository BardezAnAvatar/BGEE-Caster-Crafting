# Declarations
This mod will have capabilities to do some level of auto-detection, but it is preferred that any 
mappings of scrolls and spells to be as explicit as possible, so as to reduce margin for error.

As an example, a mod that allows scrolls of enhanced caster level (such as 5 magic missiles, not 1)
would be better to register explictly rather than to estimate, especially since caster levels are 
not always honored by scroll items. Furthermore: there is no resref matching that exists between potions
and spells or wands and spells, so registration is really the first, best approach to mod integration.


# Technical Approach
This mod will read some metadata files that can be generated by other mods, and this one, and shared
across installs, inside of the `./weidu-external` directory. It will look for both whitelist and 
blacklist metadata, which can allow or prevent specific scrolls from being crafted. Giving whitelist and
blacklist capability to override the auto-detection gives a bit more control for modder peers.


## Auto-detection
If a spell is registered in the class list for Mages/Sorcerers, Clerics, Paladins, Druids, Rangers, 
Shamans, or Bards, then the spell will be assumed as a valid target for scribing. The mod will thus 
check these spell lists.

The mod will examine all \*.itm files for scrolls that exist, which offers an ability of opcode 147
(learn spell).

Finally, the list will be cross-references with matches between the two above, adding to the metadata
files discussed prior. Whitelist and blacklist will override this collection. 

## Result
Finally, the overall data is coallated into a compiled dialog for crafting: by spell level, by spell 
inside that level, and by caster level desired.


# Integration
Due to the above, it is intended that modders be given an ease-of-use method of creating 
new spell registrations. As such, a *.tph file will be offered containing a function that will 
accept the spell mappings, metadata, and write to a shared file. This mod will read this registry file
(if it exists) and add to it if necessary, and create a crafting system accessible by PCs to craft the 
spell scrolls.


# Location
## Scrolls
A special file, `scroll-crafting.2da` will exist in the game root folder 
`./weidu-external/caster-crafting-integration/`


# Format
## Scrolls
Metadata determined as necessary for scroll crafting:
- Spell ResRef
- Scroll ResRef
- Scroll tradition/type (arcane, divine, druid, protection)
- Spell level
- Effective caster level of the scroll
- StrRef of spell name
- StrRef of spell description
- Gold cost of the scroll (optional)
- Gold cost of extra materials for the spell (i.e.: expensive diamonds) (optional)
- XP cost for the scroll crafting (optional)
- Failure probability of crafting the scroll (optional)
- Cursed? (optional)

## Potions
Metadata determined as necessary for potion crafting:
- Spell ResRef(s)
- Potion ResRef
- Caster level of the potion
- Cursed? (optional)

## Wands
Metadata determined as necessary for wand crafting:
- Spell ResRef(s)
- Wand ResRef
- Caster level of the wand